<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UA ëŒ€ê¸°ì—´ ëŒ€ì‹œë³´ë“œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            padding: 10px;
            font-family: Arial, sans-serif;
        }

        h1 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            text-align: center;
        }

        .controls {
            margin-bottom: 10px;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .lunch-input {
            flex: 1;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .lunch-button {
            padding: 5px 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .lunch-button:hover {
            background-color: #45a049;
        }

        .lunch-notification {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 10px;
            background-color: #f12d2d;
            color: white;
            border-radius: 4px;
            display: none;
        }

        .table-container {
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            table-layout: fixed;
            font-size: 0.9rem;
        }

        th, td {
            text-align: center;
            padding: 5px;
            border: 1px solid #ddd;
            min-width: 10px;
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* RT ì—´ì˜ ì´ëª¨ì§€ ìŠ¤íƒ€ì¼ */
        td:nth-child(6) {
            font-size: 1.2rem;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            cursor: pointer;
        }

        td:nth-child(6):hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        th {
            background-color: #f2f2f2;
            position: relative;
            font-weight: bold;
        }

        th:hover {
            cursor: col-resize;
        }

        .resize-handle {
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background-color: #ccc;
            cursor: col-resize;
        }

        /* ìƒíƒœë³„ ë°°ê²½ìƒ‰ */
        .status-available {
            background-color: #14ee46; /* ì—°í•œ ì´ˆë¡ìƒ‰ */
            color: #155724;
        }

        .status-on-contact, .status-Outbound, .status-bomgar, .status-case {
            background-color: #fff565; /* ì—°í•œ ì£¼í™©ìƒ‰ */
            color: #494d1d;
        }

        .status-coaching, .status-Nesting {
            background-color: #e902b7; /* ì—°í•œ ë³´ë¼ìƒ‰ */
            color: #140011;
        }

        .status-lunch, .status-break {
            background-color: #ff9f0f; /* ì—°í•œ ë…¸ë€ìƒ‰ */
            color: #27200a;
        }

        .status-offline, .status-After-contact-work {
            background-color: #f8d7da; /* ì—°í•œ ë¹¨ê°„ìƒ‰ */
            color: #721c24;
        }
        
        .status-other {
            background-color: #e2e3e5; /* ì—°í•œ íšŒìƒ‰ */
            color: #383d41;
        }

        /* ì‹œê°„ ì´ˆê³¼ ìŠ¤íƒ€ì¼ */
        .time-exceeded {
            background-color: #f8d7da; /* ì—°í•œ ë¹¨ê°„ìƒ‰ */
            color: #721c24;
            font-weight: bold;
        }

        /* ì ì‹¬ ì‹œê°„ ì„ë°• ìŠ¤íƒ€ì¼ */
        .lunch-soon {
            background-color: #f12d2d;
            color: white;
            font-weight: bold;
            cursor: pointer;
        }

        /* ì ìœ ìœ¨ ìŠ¤íƒ€ì¼ */
        .occupancy-high {
            color: #dc3545; /* ë¶‰ì€ìƒ‰ */
            font-weight: bold;
        }

        .occupancy-medium {
            color: #02ad10; /* ì£¼í™©ìƒ‰ */
            font-weight: bold;
        }

        .occupancy-low {
            color: #c20707; /* ì§„í•œ ì´ˆë¡ìƒ‰ */
            font-weight: bold;
        }

        /* ì¹¼ëŸ¼ ìˆ¨ê¹€ ì»¨íŠ¸ë¡¤ ìŠ¤íƒ€ì¼ */
        .column-controls {
            margin: 10px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 4px;
        }

        .column-checkbox {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }

        .column-checkbox input[type="checkbox"] {
            cursor: pointer;
        }

        /* ìˆ¨ê²¨ì§„ ì¹¼ëŸ¼ ìŠ¤íƒ€ì¼ */
        .hidden-column {
            display: none;
        }

        /* ëª¨ë°”ì¼ í™˜ê²½ì—ì„œì˜ ìŠ¤íƒ€ì¼ */
        @media screen and (max-width: 768px) {
            body {
                padding: 5px;
            }

            h1 {
                font-size: 1.2rem;
            }

            table {
                font-size: 0.8rem;
            }

            th, td {
                padding: 3px;
            }

            /* ëª¨ë°”ì¼ì—ì„œë„ ì´ëª¨ì§€ í¬ê¸° ìœ ì§€ */
            td:nth-child(6) {
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <h1>UA ëŒ€ê¸°ì—´ ëŒ€ì‹œë³´ë“œ</h1>
    <div class="controls">
        <textarea class="lunch-input" placeholder="ì—‘ì…€ì—ì„œ ë³µì‚¬í•œ ì ì‹¬ ì‹œê°„ ë°ì´í„°ë¥¼ ì—¬ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”"></textarea>
        <button class="lunch-button">ì ì‹¬ ì‹œê°„ ì ìš©</button>
    </div>
    <div class="column-controls" id="columnControls">
        <!-- ì²´í¬ë°•ìŠ¤ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
    </div>
    <div class="lunch-notification" id="lunchNotification"></div>
    <div class="table-container">
        <table border="1" id="agentTable">
            <thead>
                <tr>
                    <th>ì´ë¦„</th>   
                    <th>ì—°ê²°</th>
                    <th>ìƒíƒœ</th>
                    <th>ë‹¤ìŒìƒíƒœ</th>
                    <th>ì‹œê°„</th>
                    <th>RT</th>
                    <th>ì ìœ ìœ¨</th>
                    <th>CaAHT</th>
                    <th>ChAHT</th>
                    <th>ì²˜ë¦¬í˜¸</th>                
                </tr>
            </thead>
            <tbody>
                <!-- ë°ì´í„°ê°€ ì—¬ê¸°ì— ì±„ì›Œì§„ë‹¤ -->
            </tbody>
        </table>
    </div>

    <script>
        // ì ì‹¬ ì‹œê°„ ë°ì´í„° ì €ì¥
        let lunchSchedule = {};
        let dismissedLunchAlerts = new Set(); // í•´ì œëœ ì•Œë¦¼ ì €ì¥

        // ìƒë‹´ì‚¬ ì´ë¦„ê³¼ conID ë§¤í•‘
        const agentMapping = {
            "ì •ë‹¤ë¯¸": "con21488",
            "ê¶Œì´í˜„": "con75373",
            "ê¹€ëª…ë³´": "con75417",
            "ì†¡ì¬í˜": "con22514",
            "ì „ì¹˜ìš©": "con85627",
            "ì†ì§€ì€": "con40568",
            "ì •ì£¼í™˜": "con73031",
            "ì •ì§€ì¸": "con67102",
            "ìµœì°¬ë¯¸": "con70004",
            "ì´í•˜ëŠ˜": "con55155",
            "ìœ¤ì§€í›ˆ": "con47755",
            "ì†¡ì°½í˜¸": "con36753",
            "ë³µí¬ì •": "con55138",
            "ê¶Œì•„ë¦„": "con17538",
            "ë°•ì§€ì„ ": "con06366",
            "ì€ìœ ì •": "con36550",
            "ìµœì§„í˜¸": "con32266",
            "í—ˆì •í˜„": "con20027",
            "ê°•í˜¸ì² ": "con25254",
            "ê°•ì£¼ì˜": "con20546",
            "ì´ì†Œí˜•": "con51073",
            "í™ìŠ¹ì™„": "con72813",
            "ì†ì€ì„œ": "con34777",
            "ê¹€ì„±ìˆ˜": "con15576",
            "í—ˆì†Œì˜": "con85772",
            "ì´ëŒ€í¬": "con00675",
            "ê¶Œì„ í¥": "con04808",
            "ë°•ë™í™˜": "con01845",
            "ì´ê±´í¬": "con42160",
            "ì´ìƒê·œ": "con71643"
        };

        // ì ì‹¬ ì‹œê°„ ë°ì´í„° íŒŒì‹±
        function parseLunchSchedule(text) {
            const lines = text.split('\n');
            const schedule = {};
            
            lines.forEach(line => {
                const parts = line.trim().split('\t');
                if (parts.length >= 2) {
                    const name = parts[0];
                    const time = parts[1];
                    if (name && time) {
                        schedule[name] = time;
                    }
                }
            });
            
            return schedule;
        }

        // ì‹œê°„ ë¬¸ìì—´ì„ ë¶„ ë‹¨ìœ„ë¡œ ë³€í™˜
        function timeToMinutes(timeStr) {
            if (!timeStr) return 0;
            const parts = timeStr.split(':');
            if (parts.length === 2) {
                return parseInt(parts[0]) * 60 + parseInt(parts[1]);
            }
            return 0;
        }

        // í˜„ì¬ ì‹œê°„ê³¼ ì ì‹¬ ì‹œê°„ ë¹„êµ
        function checkLunchTime() {
            const now = new Date();
            const currentMinutes = now.getHours() * 60 + now.getMinutes();
            
            Object.entries(lunchSchedule).forEach(([name, time]) => {
                if (dismissedLunchAlerts.has(name)) return; // í•´ì œëœ ì•Œë¦¼ì€ ë¬´ì‹œ
                
                const lunchMinutes = timeToMinutes(time);
                const timeDiff = lunchMinutes - currentMinutes;
                
                if (timeDiff > 0 && timeDiff <= 15) {
                    showNotification(`${name} ìƒë‹´ì‚¬ì˜ ì ì‹¬ ì‹œê°„ì´ ${timeDiff}ë¶„ í›„ì…ë‹ˆë‹¤.`);
                }
            });
        }

        // ì•Œë¦¼ í‘œì‹œ
        function showNotification(message) {
            const notification = document.getElementById('lunchNotification');
            notification.textContent = message;
            notification.style.display = 'block';
            setTimeout(() => {
                notification.style.display = 'none';
            }, 5000);
        }

        // ì ì‹¬ ì‹œê°„ ì ìš© ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
        document.querySelector('.lunch-button').addEventListener('click', function() {
            const input = document.querySelector('.lunch-input');
            lunchSchedule = parseLunchSchedule(input.value);
            dismissedLunchAlerts.clear(); // ìƒˆë¡œìš´ ë°ì´í„° ì ìš© ì‹œ í•´ì œëœ ì•Œë¦¼ ì´ˆê¸°í™”
            showNotification('ì ì‹¬ ì‹œê°„ì´ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.');
            
            // 1ë¶„ë§ˆë‹¤ ì ì‹¬ ì‹œê°„ ì²´í¬
            setInterval(checkLunchTime, 60000);
            checkLunchTime(); // ì¦‰ì‹œ í•œ ë²ˆ ì²´í¬
        });

        // ì¹¼ëŸ¼ ìˆ¨ê¹€ ìƒíƒœ ì €ì¥
        let hiddenColumns = new Set();

        // ì¹¼ëŸ¼ ìˆ¨ê¹€ ê¸°ëŠ¥ ì´ˆê¸°í™”
        function initializeColumnControls() {
            const columnControls = document.getElementById('columnControls');
            const table = document.getElementById('agentTable');
            const headers = table.querySelectorAll('th');
            
            headers.forEach((header, index) => {
                const checkbox = document.createElement('div');
                checkbox.className = 'column-checkbox';
                
                const input = document.createElement('input');
                input.type = 'checkbox';
                input.checked = true;
                input.id = `column-${index}`;
                
                const label = document.createElement('label');
                label.htmlFor = `column-${index}`;
                label.textContent = header.textContent;
                
                checkbox.appendChild(input);
                checkbox.appendChild(label);
                columnControls.appendChild(checkbox);
                
                // ì²´í¬ë°•ìŠ¤ ìƒíƒœ ë³€ê²½ ì´ë²¤íŠ¸
                input.addEventListener('change', function() {
                    const isChecked = this.checked;
                    const columnIndex = index + 1; // nth-childëŠ” 1ë¶€í„° ì‹œì‘
                    
                    if (isChecked) {
                        hiddenColumns.delete(columnIndex);
                    } else {
                        hiddenColumns.add(columnIndex);
                    }
                    
                    updateColumnVisibility();
                });
            });
        }

        // ì¹¼ëŸ¼ ê°€ì‹œì„± ì—…ë°ì´íŠ¸
        function updateColumnVisibility() {
            const table = document.getElementById('agentTable');
            const headers = table.querySelectorAll('th');
            
            headers.forEach((header, index) => {
                const columnIndex = index + 1;
                const isHidden = hiddenColumns.has(columnIndex);
                
                if (isHidden) {
                    header.classList.add('hidden-column');
                    const dataCells = table.querySelectorAll(`td:nth-child(${columnIndex})`);
                    dataCells.forEach(cell => cell.classList.add('hidden-column'));
                } else {
                    header.classList.remove('hidden-column');
                    const dataCells = table.querySelectorAll(`td:nth-child(${columnIndex})`);
                    dataCells.forEach(cell => cell.classList.remove('hidden-column'));
                }
            });
        }

        // DOMì´ ë¡œë“œëœ í›„ ì¹¼ëŸ¼ ì»¨íŠ¸ë¡¤ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            initializeColumnControls();
            
            // ê¸°ì¡´ì˜ ì…€ ë„ˆë¹„ ì¡°ì ˆ ê¸°ëŠ¥
            const table = document.getElementById('agentTable');
            const ths = table.querySelectorAll('th');
            
            ths.forEach((th, index) => {
                const handle = document.createElement('div');
                handle.className = 'resize-handle';
                th.appendChild(handle);
                
                let startX, startWidth;
                
                handle.addEventListener('mousedown', function(e) {
                    startX = e.pageX;
                    startWidth = th.offsetWidth;
                    
                    document.addEventListener('mousemove', resize);
                    document.addEventListener('mouseup', stopResize);
                    e.preventDefault(); // ë“œë˜ê·¸ ë°©ì§€
                });
                
                function resize(e) {
                    const width = startWidth + (e.pageX - startX);
                    if (width >= 10 && width <= 200) {
                        // í•´ë‹¹ ì—´ì˜ ëª¨ë“  ì…€ ë„ˆë¹„ ë³€ê²½
                        const newWidth = width + 'px';
                        th.style.width = newWidth;
                        const tds = table.querySelectorAll(`td:nth-child(${index + 1})`);
                        tds.forEach(td => {
                            td.style.width = newWidth;
                        });
                    }
                }
                
                function stopResize() {
                    document.removeEventListener('mousemove', resize);
                    document.removeEventListener('mouseup', stopResize);
                }
            });
        });

        // RT ê°’ì„ ì´ëª¨ì§€ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
        function getRTEmoji(rtValue) {
            if (rtValue.includes('KO UA Experienced')) {
                return 'ğŸ’¬'; // ì±„íŒ… ì•„ì´ì½˜
            } else if (rtValue.includes('KO UA Intermediate')) {
                return 'ğŸ“'; // ì „í™” ì•„ì´ì½˜
            }
            return rtValue; // ë‹¤ë¥¸ ê°’ì€ ê·¸ëŒ€ë¡œ ë°˜í™˜
        }

        // ìƒíƒœì— ë”°ë¥¸ í´ë˜ìŠ¤ ë°˜í™˜
        function getStatusClass(status) {
            if (!status || status === '-') return '';
            status = status.toLowerCase();
            if (status.includes('available')) {
                return 'status-available';
            } else if (status.includes('on contact') || status.includes('outbound') || status.includes('bomgar') || status.includes('case')) {
                return 'status-on-contact';
            } else if (status.includes('coaching') || status.includes('nesting')) {
                return 'status-coaching';
            } else if (status.includes('lunch')) {
                return 'status-lunch';
            } else if (status.includes('break')) {
                return 'status-break';
            } else if (status.includes('offline') || status.includes('after contact work')) {
                return 'status-offline';
            }
            return 'status-other';
        }

        // ì‹œê°„ ë°ì´í„° ì €ì¥ìš© (í–‰ë³„ë¡œ ê´€ë¦¬)
        let agentTimeStates = []; // [{rowIdx, baseSeconds, displaySeconds, lastUpdate: Date}]

        // ì‹œê°„ ë¬¸ìì—´ì„ ì´ˆ ë‹¨ìœ„ë¡œ ë³€í™˜
        function timeToSeconds(timeStr) {
            if (!timeStr || timeStr === '-' || timeStr === '') return 0;
            const parts = timeStr.split(':');
            if (parts.length === 3) {
                return parseInt(parts[0]) * 3600 + parseInt(parts[1]) * 60 + parseInt(parts[2]);
            } else if (parts.length === 2) {
                return parseInt(parts[0]) * 60 + parseInt(parts[1]);
            }
            return 0;
        }

        // ì´ˆë¥¼ ì‹œê°„ ë¬¸ìì—´ë¡œ ë³€í™˜ (í•­ìƒ H:MM:SS, ì‹œëŠ” í•œ ìë¦¬ë©´ 0 ì—†ì´)
        function secondsToTime(seconds) {
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const remainingSeconds = seconds % 60;
            return (
                hours + ':' +
                minutes.toString().padStart(2, '0') + ':' +
                remainingSeconds.toString().padStart(2, '0')
            );
        }

        // ì‹œê°„ì´ 16ë¶„ 30ì´ˆ(990ì´ˆ)ë¥¼ ì´ˆê³¼í•˜ëŠ”ì§€ í™•ì¸
        function isTimeExceeded(timeStr) {
            const seconds = timeToSeconds(timeStr);
            return seconds > 990; // 16ë¶„ 30ì´ˆ = 990ì´ˆ
        }

        // --- ì‹¤ì‹œê°„ ì‹œê°„ ì¦ê°€ ê¸°ëŠ¥ ì¶”ê°€ ---
        let timeInterval = null;

        function startAgentTimeTicker() {
            if (timeInterval) clearInterval(timeInterval);
            timeInterval = setInterval(() => {
                // 1ì´ˆë§ˆë‹¤ ëª¨ë“  í–‰ì˜ ì‹œê°„ displaySecondsë¥¼ 1ì´ˆì”© ì¦ê°€
                agentTimeStates.forEach(state => {
                    state.displaySeconds += 1;
                    // í…Œì´ë¸”ì—ì„œ í•´ë‹¹ ì…€ì„ ì°¾ì•„ì„œ ê°±ì‹ 
                    const table = document.getElementById('agentTable');
                    const row = table.tBodies[0].rows[state.rowIdx];
                    if (row) {
                        // "ì‹œê°„" ì¹¼ëŸ¼ì€ 5ë²ˆì§¸(td[4])ì„
                        const cell = row.cells[4];
                        if (cell) {
                            cell.textContent = secondsToTime(state.displaySeconds);
                            // ì‹œê°„ ì´ˆê³¼ ìŠ¤íƒ€ì¼ ì ìš©
                            if (state.displaySeconds > 990) {
                                cell.classList.add('time-exceeded');
                            } else {
                                cell.classList.remove('time-exceeded');
                            }
                        }
                    }
                });
            }, 1000);
        }

        // --- loadData í•¨ìˆ˜ ìˆ˜ì • ---
        async function loadData() {
            try {
                const response = await fetch("https://dashboard-server-8neo.onrender.com/data", {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    mode: 'cors'
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                const tableBody = document.querySelector("#agentTable tbody");
                tableBody.innerHTML = "";

                agentTimeStates = []; // ìƒˆ ë°ì´í„°ë§ˆë‹¤ ì´ˆê¸°í™”

                data.forEach((agent, rowIdx) => {
                    const row = document.createElement("tr");
                    let agentName = "";

                    Object.entries(agent).forEach(([key, value], colIdx) => {
                        const cell = document.createElement("td");

                        // ì´ë¦„ ì €ì¥
                        if (key === "ì´ë¦„") {
                            agentName = value;
                        }

                        // RT ì—´ì¸ ê²½ìš° ì´ëª¨ì§€ë¡œ ë³€í™˜
                        if (key === "ë¼ìš°íŒ… í”„ë¡œí•„") {
                            cell.textContent = getRTEmoji(value);
                            cell.addEventListener('click', function() {
                                const conID = agentMapping[agentName];
                                if (conID) {
                                    const url = `https://adb-oac-prod.my.connect.aws/users#/?typeaheadLoginName=%22${conID}%22`;
                                    window.open(url, '_blank');
                                }
                            });
                        } else {
                            cell.textContent = value;
                        }

                        // ìƒíƒœì™€ ë‹¤ìŒìƒíƒœ ì—´ì— ìŠ¤íƒ€ì¼ ì ìš©
                        if (key === "ìƒíƒœ" || key === "ë‹¤ìŒìƒíƒœ") {
                            cell.className = getStatusClass(value);
                        }

                        // ì‹œê°„ ê´€ë ¨ ì—´ì— ìŠ¤íƒ€ì¼ ì ìš© ë° ì‹¤ì‹œê°„ ì‹œê°„ ê´€ë¦¬
                        if (key === "ì‹œê°„") {
                            // ì‹œê°„ ê°’ ì €ì¥ (ì´ˆ ë‹¨ìœ„)
                            const baseSeconds = timeToSeconds(value);
                            agentTimeStates.push({
                                rowIdx,
                                baseSeconds,
                                displaySeconds: baseSeconds,
                                lastUpdate: new Date()
                            });
                            // ì‹œê°„ ì´ˆê³¼ ìŠ¤íƒ€ì¼ ì ìš©
                            if (baseSeconds > 990) {
                                cell.className = 'time-exceeded';
                            }
                        }
                        if (key === "CaAHT" || key === "ChAHT") {
                            if (isTimeExceeded(value)) {
                                cell.className = 'time-exceeded';
                            }
                        }

                        // ì ìœ ìœ¨ ìŠ¤íƒ€ì¼ ì ìš©
                        if (key === "ì ìœ ìœ¨") {
                            const occupancy = parseFloat(value);
                            if (!isNaN(occupancy)) {
                                if (occupancy >= 85) {
                                    cell.className = 'occupancy-high';
                                } else if (occupancy >= 55) {
                                    cell.className = 'occupancy-medium';
                                } else {
                                    cell.className = 'occupancy-low';
                                }
                            }
                        }

                        // ì ì‹¬ ì‹œê°„ ì„ë°• ì²´í¬
                        if (key === "ì´ë¦„" && lunchSchedule[value] && !dismissedLunchAlerts.has(value)) {
                            const now = new Date();
                            const currentMinutes = now.getHours() * 60 + now.getMinutes();
                            const lunchMinutes = timeToMinutes(lunchSchedule[value]);
                            const timeDiff = lunchMinutes - currentMinutes;

                            if (timeDiff > 0 && timeDiff <= 15) {
                                cell.classList.add('lunch-soon');
                                cell.addEventListener('click', function() {
                                    cell.classList.remove('lunch-soon');
                                    dismissedLunchAlerts.add(value);
                                });
                            }
                        }

                        row.appendChild(cell);
                    });
                    tableBody.appendChild(row);
                });

                // ë°ì´í„° ë¡œë“œ í›„ ì¹¼ëŸ¼ ê°€ì‹œì„± ì—…ë°ì´íŠ¸
                updateColumnVisibility();

                // ì‹¤ì‹œê°„ ì‹œê°„ ì¦ê°€ íƒ€ì´ë¨¸ ì‹œì‘/ê°±ì‹ 
                startAgentTimeTicker();

            } catch (error) {
                console.error('Error loading data:', error);
            }
        }//ì €ì¥ì¢€ë¼ë¼ ì‹œë°œ

        setInterval(loadData, 5000); // 5ì´ˆë§ˆë‹¤ ë°ì´í„° ê°±ì‹ 
        loadData(); // ì²˜ìŒ ë¡œë”©
    </script>
</body>
</html>


